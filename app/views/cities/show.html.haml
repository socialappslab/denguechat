= render :partial => "shared/flashes"
= render :partial => "shared/form_errors", :locals => {:item => @team}

- content_for :scripts do
  %script{"src" => "https://www.google.com/jsapi?autoload={'modules':[{'name':'visualization','version':'1.1','packages':['corechart']}]}"}
  :javascript
    $(document).ready(function() {
      $('[data-toggle="popover"]').hover(function(el) { $(el.currentTarget).popover("toggle"); })
    })
  :css
    .popover {
      position: fixed;
      z-index: 1000;
    }

- content_for :head do
  %meta{:property => "og:title",       :content => "Ciudadanos de #{@city.name} en el combate contra el Dengue, Zika y la Chikungunya"}
  %meta{:property => "og:description", :content => "DengueChat involucra a las comunidades en la lucha contra el Dengue, Zika y la Chikungunya"}
  %meta{:property => "og:type",        :content => "article"}

.container{"ng-controller" => "cityCtrl"}
  .row
    .col-md-3
      .well{:style => "padding-top: 0px; padding-left: 0px; padding-right: 0px;"}
        = image_tag(@city.photo, :style => "width: 100%;")
        %p.lato-font.text-center{"style" => "font-size: 24px; margin-top: 10px; margin-bottom: 20px;"}
          = @city.name
        %div{:style => "padding-left: 15px; padding-right: 15px;"}
          = select_tag "city", options_for_select(@cities.map {|c| [c.name, c.id]}), :prompt => "Visita otras ciudades...", :class => "form-control", "ng-model" => "chosenCity"

      .well
        %p.form-label
          = I18n.t("activerecord.models.neighborhood", :count => 2)
        - @neighborhoods.each do |neighborhood|
          .text-center
            = link_to neighborhood_path(neighborhood) do
              - image_tag(asset_path(neighborhood.picture), :class => "img-rounded", :style => "height: 200px; width: 200px;")
            %p.lato-font.text-center{"style" => "margin-top: 10px; margin-bottom: 20px; font-size: 18px;"}
              = link_to neighborhood.name, neighborhood_path(neighborhood)
              %span{:style => "color: #5cb85c;"}
                = @neighborhood_rankings.find {|nr| nr[:id] == neighborhood.id}[:score]
          %hr.muted.slightly-wide

    .col-md-3.col-md-push-6{"ng-controller" => "greenLocationsChartCtrl", "city" => @city.to_json, "green_locations_path" => green_locations_api_v0_graph_path}
      .panel.panel-default
        .panel-heading{"data-content" => "Una Casa Verde es un hogar que en un periodo de por lo menos dos meses no tiene criaderos ni positivos ni potenciales, documentados en dos visitas consecutivas por una brigada DengueChat. Brigadistas responsables de mantener una Casa Verde ganan 200 puntos.", "data-toggle" => "popover", "data-placement" => "bottom", "data-trigger" => "hover"}
          %h3.panel-title
            Casas Verdes
            .pull-right
              %i.fa.fa-question-circle{"style" => "color: #8E8E93;"}
        - if @green_location_rankings.blank?
          .panel-body
            %p.lato-font.large-font.text-center
              No hay puntos
        - else
        
          %table.table.green-houses
            %tbody
              - @green_location_rankings.each do |user_prueba|
                
                - next if user_prueba.blank?
                %tr
                  %td{"style" => "vertical-align: middle;"}
                    = image_tag(user_prueba.picture, :style => "height: 50px; width: 50px;", :class => "img-rounded")
                  %td{"style" => "vertical-align: middle;"}
                    .light-font
                      = user_prueba.username
                  %td{"style" => "vertical-align: middle;"}
                    %p.largest-font.heavy-font.text-right.green
                      = user_prueba.total_points.to_i

      .panel.panel-default
        .panel-heading
          %h3.panel-title
            GrÃ¡fico de casas verdes
        .panel-body
          %h1.text-center{"ng-show" => "chartLoading == true"}
            %i.fa.fa-spin.fa-refresh
          #green-locations-chart-minor


    .col-md-6.col-md-pull-3{"ng-controller" => "DCPostListCtrl", :posts_path => api_v0_posts_path(:city_id => @city.id), "usernames" => User.pluck(:username), "hashtags" => Hashtag.official_hashtags, "neighborhood_id" => (@current_user && @current_user.neighborhood_id) }
      - if @current_user
        %new-post-custom

      = render :partial => "shared/filter_posts"
      = render :partial => "shared/feed"
