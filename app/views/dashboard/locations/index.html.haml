- content_for :dashboard_content do
  %div{"ng-controller" => "locationListCtrl", "neighborhood" => @neighborhood.to_json(:only => [:id])}
    .table-header-view

      .row
        .col-md-6
          = form_tag set_cookies_users_path, :method => "POST", :class => "form-inline" do
            .form-group
              %p.form-control-static
                = I18n.t("attributes.neighborhood_id")
            .form-group
              = select_tag "neighborhood_id", options_for_select(@neighborhoods_select, :selected => @neighborhood.id),  :class => "form-control"
            = submit_tag I18n.t("views.buttons.submit"), :class => "btn btn-success"

        .col-md-6
          .pull-right
            .checkbox{"style" => "margin-top: 20px;"}
              = label_tag do
                = check_box_tag "options[csv_only]", "1", true, "ng-model" => "dataOptions.csvOnly", "ng-true-value" => "'1'", "ng-false-value" => "null"
                = I18n.t("views.dashboard.csv_only")


    -# .input-group.input-group-lg
    -#   %span.input-group-addon
    -#     .fa.fa-search
    -#   %input#search-filter.form-control{:placeholder => "Search by location or visit date", :type => "text", "ng-model" => "searchText"}/


    .row
      .col-md-12
        .error-message{"ng-show" => "serverError"}
          %p.text-center.text-warning
            Algo saliÃ³ mal. Por favor, intente nuevamente.

        %h1.text-center{"ng-show" => "loading"}
          %i.fa.fa-refresh.fa-spin

        %table.table.table-bordered.table-hover.text-center.statistics-table{"ng-hide" => "loading"}
          %thead
            %th.text-center
              = I18n.t("attributes.location_id")
            %th.text-center
              Casa verde?
            %th.text-center
              = I18n.t("views.dashboard.locations.visit_summary")
            %th.text-center
              = I18n.t("views.dashboard.locations.visit_date")
            %th.text-center
              = I18n.t("views.dashboard.locations.status")
            %th.text-center
              = I18n.t("views.dashboard.locations.total_positive_sites")
            %th.text-center
              = I18n.t("views.dashboard.locations.total_potential_sites")
            %th.text-center
              = I18n.t("views.dashboard.locations.barrel_summary")
          %tbody
            %tr.thick-border{"ng-repeat-start" => "location in locations"}
              %td{:rowspan => "{{location.visits.length + 1}}", "style" => "width: 10%;"}
                {{ location.address }}
              %td{:rowspan => "{{location.visits.length + 1}}", "style" => "width: 7%;", "ng-class" => "location.green ? 'success' : 'danger'"}
                %i.fa{"ng-class" => "location.green ? 'fa-check': 'fa-close'"}


              %td{:rowspan => "{{location.visits.length + 1}}", "style" => "width: 20%"}
                .progress
                  .progress-bar.progress-bar-success{"style" => "width: 33%;"}
                    {{ (location.visits | filter:{identification_type:2}).length }}
                  .progress-bar.progress-bar-warning{"style" => "width: 34%;"}
                    {{ (location.visits | filter:{identification_type:1}).length }}
                  .progress-bar.progress-bar-danger{"style" => "width: 33%;"}
                    {{ (location.visits | filter:{identification_type:0}).length }}

              %td{"ng-if" => "location.visits.length === 0"}
              %td{"ng-if" => "location.visits.length === 0"}
              %td{"ng-if" => "location.visits.length === 0"}
              %td{"ng-if" => "location.visits.length === 0"}
              %tr{"ng-repeat" => "visit in location.visits", "ng-if" => "location.visits.length !== 0"}
                %td{"style" => "width: 20%;"}
                  {{visit.timestamp}}
                %td{"style" => "width: 7%;"}
                  %span.label.status-label{"class" => "{{visit.class}}"}
                    %nbsp
                %td{"style" => "width: 10%;"}
                  {{ (visit.inspections | filter:{identification_type:0}).length }}
                %td{"style" => "width: 10%;"}
                  {{ (visit.inspections | filter:{identification_type:1}).length }}
                %td.text-left{"style" => "width: 10%;"}
                  {{ visit.barrel_reports.protected }}
                  = I18n.t("activerecord.attributes.report.protected")
                  %br
                  {{ visit.barrel_reports.larvae }}
                  = I18n.t("activerecord.attributes.report.larvae")
                  %br
                  {{ visit.barrel_reports.pupae }}
                  = I18n.t("activerecord.attributes.report.pupae")
                  %br
                  {{ visit.barrel_reports.chemically_treated }}
                  = I18n.t("activerecord.attributes.report.chemically_treated")


            %tr{"ng-repeat-end" => true}

  - content_for :scripts do
    = javascript_include_tag "application"
