- content_for :dashboard_content do
  .table-header-view

    .row
      .col-md-12.text-center
        = form_tag set_cookies_users_path, :method => "POST", :class => "form-inline" do
          .form-group
            %p.form-control-static
              = I18n.t("attributes.neighborhood_id")
          .form-group
            = select_tag "neighborhood_id", options_for_select(@neighborhoods_select, :selected => @neighborhood.id),  :class => "form-control"
          = submit_tag "Submit", :class => "btn btn-success"


  .row
    .col-md-12
      %table.table.table-bordered.table-hover.text-center.statistics-table
        %thead
          %th.text-center
            = I18n.t("activerecord.attributes.report.location_id")
          %th.text-center
            Visit time
          %th.text-center
            Number of positive sites
          %th.text-center
            Number of potential sites
          %th.text-center
            Status
        %tbody
          - @locations.each do |loc|
            %tr.thick-border
              // NOTE: rowspan should always be +1 since it's counting its own
              // tr as well.
              - row_span = loc.visits.count + 1
              %td{:rowspan => row_span }
                = loc.address
                = loc.inspect

              - if loc.visits.count == 0
                %td
                %td
                %td
                %td
              - else
                - loc.visits.order("visited_at ASC").includes(:inspections).each do |visit|
                  %tr
                    %td
                      = format_csv_timestamp(visit.visited_at)
                    %td
                      = visit.inspections.where(:identification_type => Inspection::Types::POSITIVE).count
                    %td
                      = visit.inspections.where(:identification_type => Inspection::Types::POTENTIAL).count
                    %td{:class => class_for_status(visit.identification_type)}
