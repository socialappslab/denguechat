%nav.navbar.navbar-default#header
  .container-fluid
    / Brand and toggle get grouped for better mobile display
    .navbar-header
      %button.navbar-toggle.collapsed{"aria-expanded" => "false", "data-target" => "#header-collapse", "data-toggle" => "collapse", :type => "button"}
        %span.sr-only Toggle navigation
        %span.icon-bar
        %span.icon-bar
        %span.icon-bar
      = link_to (@current_user.present? ? user_path(@current_user) : root_path), :class => "navbar-brand" do
        = logo_image

    #header-collapse.collapse.navbar-collapse
      %ul.nav.navbar-nav.user-navigation
        %li
          %a
        -# %li.user-navigation{:class => "#{request.path == city_path(@current_user.city) ? 'active' : ''}"}
        -#   = link_to city_path(@current_user.city), :style => header_styling do
        -#     %i.fa.fa-globe
        -#     = I18n.t("dashboard.my_city")
        %li.dropdown.text-center.user-navigation{:class => "#{request.params["controller"] == "cities" ? 'active' : ''}"}
          = link_to city_path(@current_user.city), :data => {:toggle=>"dropdown"} do
            %i.fa.fa-globe
            = I18n.t("dashboard.my_city")
            %i.fa.fa-angle-down
          %ul.dropdown-menu
            %li
              = link_to city_path(@current_user.city) do
                = I18n.t("dashboard.my_city")
            %li.divider
            - @all_cities.each do |city|
              %li
                = link_to city_path(city) do
                  = city.name


        %li
          %a
        %li.dropdown.text-center.user-navigation{:class => "#{request.params["controller"] == "neighborhoods" ? 'active' : ''}"}
          = link_to neighborhood_path(@current_user.neighborhood), :data => {:toggle=>"dropdown"} do
            %i.fa.fa-globe
            = I18n.t("dashboard.my_community")
            %i.fa.fa-angle-down
          %ul.dropdown-menu
            %li
              = link_to neighborhood_path(@current_user.neighborhood) do
                = I18n.t("dashboard.my_community")
            %li.divider
            - @all_neighborhoods.each do |n|
              %li
                = link_to neighborhood_path(n) do
                  = n.name
        %li
          %a
        %li.user-navigation
          - header_styling = request.path == teams_path ? "font-weight:bold; text-align: center;" : ""
          = link_to teams_path, :style => header_styling do
            %i.fa.fa-futbol-o
            = I18n.t("activerecord.models.team", :count => 3)
        %li
          %a
        %li.user-navigation
          - header_styling = request.path == neighborhood_reports_path(@current_user.neighborhood) ? "font-weight:bold; text-align: center;" : ""
          = link_to neighborhood_reports_path(@current_user.neighborhood), :style => header_styling do
            %i.fa.fa-map-marker
            = I18n.t("dashboard.reports")
        %li
          %a
        %li.user-navigation
          - header_styling = request.path == csv_reports_path ? "font-weight:bold; text-align: center;" : ""
          = link_to csv_reports_path, :style => header_styling do
            %i.fa.fa-table
            CSV
        %li.user-navigation{:class => "#{request.params["controller"] == "organizations" ? 'active' : ''}"}
          = link_to settings_organizations_path do
            %i.fa.fa-cog
            = I18n.t("dashboard.organization.name")

      %ul.nav.navbar-nav.navbar-right
        - if @notifications.present?
          %li.user-navigation.dropdown
            %a{:href => "#", :class => "dropdown-toggle", :data => {:toggle=>"dropdown"}}
              %span.label.label-danger
                = @notifications.count
            %ul.dropdown-menu
              - @notifications.each do |n|
                %li
                  - if n.notification_type == "Post" && post = n.post
                    = link_to post_path(post) do
                      Alguien te mencionado en un chat!
                  - elsif n.notification_type == "Comment" && comment = n.comment
                    - if comment.commentable_type == "Post"
                      = link_to post_path( Post.find(comment.commentable_id) ) do
                        Alguien te mencionado en un comentario!


        = render :partial => "shared/profile_dropdown"



  - if @current_user && @current_user.selected_membership.try(:manager?) && request.params["controller"] == "organizations"
    %nav.navbar.navbar-default#subheader
      / Brand and toggle get grouped for better mobile display
      .navbar-header
        %button.navbar-toggle.collapsed{"aria-expanded" => "false", "data-target" => "#subheader-collapse", "data-toggle" => "collapse", :type => "button"}
          %span.sr-only Toggle navigation
          %span.icon-bar
          %span.icon-bar
          %span.icon-bar

      #subheader-collapse.collapse.navbar-collapse
        %ul.nav.navbar-nav.user-navigation
          %li.user-navigation{:class => "#{settings_organizations_path == request.path ? 'active' : ''}"}
            = link_to settings_organizations_path do
              = I18n.t("dashboard.organization.sections.general")
          %li.user-navigation{:class => "#{users_organizations_path == request.path ? 'active' : ''}"}
            = link_to users_organizations_path do
              = I18n.t("dashboard.organization.sections.users")
          %li.user-navigation{:class => "#{teams_organizations_path == request.path ? 'active' : ''}"}
            = link_to teams_organizations_path do
              = I18n.t("dashboard.organization.sections.teams")


  - if @breadcrumbs.present?
    %ol.breadcrumb{:style => "margin-bottom: 0px;"}
      - @breadcrumbs.each do |bc|
        %li{:class => "#{request.path == bc[:path] ? 'active' : ''}"}
          = link_to bc[:name], bc[:path]
